{% extends 'base.html' %}
{% block title %} View Tickets {% endblock %}
{% block content  %}

<div class="card shadow-sm mt-4">
    <div class="card-header">
        <div class="d-flex justify-content-between-align-items-center">
        <h1 class="h5 mb-0">My Tickets</h1>
        <a href="{% url 'create_ticket' %}" class="btn btn-primary btn-sm">Create New Tcket</a>
      
    </div>
    <p class="card-text text-muted small mt-1">A lsits of all the tickets you have submitted </p>
    </div>
    <div class="card-body">
        <div class="table-responsive">

            <table class="table table-hover align-middle">
  <thead class="table-light">
    <tr>
      <th scope="col">User Id</th>
       <th scope="col">Name</th>
      <th scope="col">Priority</th>
       <th scope="col">Create Date</th>
      <th scope="col">Status</th>
      <th scope="col" class="text-end">Actions</th>
    </tr>
  </thead>
  <tbody>
    {% for ticket in tickets %}
    <tr>
    <td class="fw-bold"> TICKET-00{{ticket.id}}</td>
    <td>{{ticket.name}}</td>
    <td>{{ticket.priority}}</td>
    <td>{{ticket.create_at|date:"Y-m-d"}}</td>

    <td>
      <span class="badge
        {% if ticket.status == 'Pending' %} bg-warning text-dark
        {% elif ticket.status == 'Accepted' %} bg-success
        {% elif ticket.status == 'Rejected' %} bg-danger {% endif %}">
        {{ticket.status}}
      </span>
    </td>
     <td class="text-end">
     <a href="{% url 'update_ticket' ticket.id %}" class="btn btn-secondary btn-sm">Edit</a>
     <form action="{% url 'delete_ticket' ticket.id %}" method="post" class="d-inline ms-1" onsubmit="return confirm('Are you sure you want to delete this time?')">
         {% csrf_token %}
         <button type="submit" class="btn tn-danger btn-sm">Delete</button>
     </form>
      </td>
    </tr>

    {% empty %}
    <tr>
      <td colspan="4" class="text-center text-muted">No Tickets.</td>
    </tr>
    {% endfor %}
    
  </tbody>
</table>
        </div>

    </div>

</div>
{% endblock %}